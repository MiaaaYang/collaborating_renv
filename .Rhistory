here::i_am(
"project4/code/01_make_output.R"
)
.libPaths("C:/Users/user/AppData/Local/R/win-library/4.5")
here::i_am(
"project4/code/01_make_output.R"
)
here::i_am(
"project4/code/01_make_output.R"
)
setwd("C:/Users/user/Documents")
here::i_am(
"project4/code/01_make_output.R"
)
here::i_am(
"project4/code/02_render_report.R"
)
set.seed(1)
random_numbers1 <- rnorm(1000)
saveRDS(
random_numbers1,
file = here::here("project4","output", "random_numbers1.rds")
)
set.seed(2)
random_numbers2 <- rgamma(1000, shape = 1)
saveRDS(
random_numbers2,
file = here::here("project4","output", "random_numbers2.rds")
)
set.seed(3)
random_numbers3 <- runif(1000)
saveRDS(
random_numbers3,
file = here::here("project4", "output", "random_numbers3.rds")
)
set.seed(4)
random_numbers4 <- rbinom(1000, 1, 0.25)
saveRDS(
random_numbers4,
file = here::here("project4", "output", "random_numbers4.rds")
)
.libPaths("C:/Users/user/AppData/Local/R/win-library/4.5")
here::i_am(
"project4/code/01_make_output.R"
)
set.seed(1)
random_numbers1 <- rnorm(1000)
saveRDS(
random_numbers1,
file = here::here("project4","output", "random_numbers1.rds")
)
set.seed(2)
random_numbers2 <- rgamma(1000, shape = 1)
saveRDS(
random_numbers2,
file = here::here("project4","output", "random_numbers2.rds")
)
set.seed(3)
random_numbers3 <- runif(1000)
saveRDS(
random_numbers3,
file = here::here("project4", "output", "random_numbers3.rds")
)
set.seed(4)
random_numbers4 <- rbinom(1000, 1, 0.25)
saveRDS(
random_numbers4,
file = here::here("project4", "output", "random_numbers4.rds")
)
library ("meta")
install.packages("meta")
library ("meta")
a <- read.csv ('C:/Users/user/Downloads/PD_MA_EXAMPLE_EFFECT.xlsx')
a <- read_excel("C:/Users/user/Downloads/PD_MA_EXAMPLE_EFFECT.xlsx")
library(readxl)
a <- read_excel("C:/Users/user/Downloads/PD_MA_EXAMPLE_EFFECT.xlsx")
View(a)
View(a)
a <- read_excel("C:/Users/user/Downloads/PD_MA_EXAMPLE_EFFECT.xlsx")
excel_sheets("C:/Users/user/Downloads/PD_MA_EXAMPLE_EFFECT.xlsx")
a <- read_excel("C:/Users/user/Downloads/PD_MA_EXAMPLE_EFFECT.xlsx", sheet = "Data" )
MA_exampleAUD = metabin(events_exposed, total_exposed, events_control, total_control, studlab=Study, sm="RR", method.tau = “DL”, da
MA_exampleAUD = metabin(events_exposed, total_exposed, events_control, total_control, studlab=Study, sm="RR", method.tau = “DL”, data=a)
MA_exampleAUD = metabin(events_exposed, total_exposed, events_control, total_control,
studlab=Study, sm="RR", method.tau = “DL”, data=a)
MA_exampleAUD <- metabin(
event.e = events_exposed,
n.e = total_exposed,
event.c = events_control,
n.c = total_control,
studlab = Study,
sm = "RR",
method.tau = "DL",
data = a
)
MA_exampleAUD <- metabin(
events_exposed, total_exposed, events_control, total_control,
studlab = Study,
sm = "OR",
method.tau = "DL",
data = a
)
MA_example2 = metagen(
Ln_Effect_estimate, Ln_SE,
data = a,
backtransf = TRUE,
sm = "OR",  method.tau = "DL")
summary(MA_example2)
forest(MA_example2)
NSCLC <- read.csv("N:/NSCLC/GALung_Text_20212022.csv.xlsx")
NSCLC_text <- read.excel("N:/NSCLC/GALung_Text_20212022.xlsx")
library(readxl)
NSCLC_text <- read.excel("N:/NSCLC/GALung_Text_20212022.xlsx")
NSCLC_text <- read.excel("N:/NSCLC/GALung_Text_20212022.xlsx")
NSCLC_text <- read_excel("N:/NSCLC/GALung_Text_20212022.xlsx")
View(NSCLC_text)
library(tidyr)
library(dplyr)
NSCLC_long <- NSCLC_text %>%
pivot_longer(
cols = c(NSCLC_text$TREATMENT_PROCEDURETEXT_BRM, NSCLC_text$TREATMENT_PROCEDURETEXT_CHEMO),
names_to = "source",
values_to = "merged_value"
) %>%
drop_na(merged_value)
NSCLC_long <- NSCLC_text %>%
pivot_longer(
cols = c(TREATMENT_PROCEDURETEXT_BRM, TREATMENT_PROCEDURETEXT_CHEMO),
names_to = "source",
values_to = "merged_value"
) %>%
drop_na(merged_value)
View(NSCLC_long)
NSCLC_long <- NSCLC_text %>%
pivot_longer(
cols = c(TREATMENT_PROCEDURETEXT_BRM, TREATMENT_PROCEDURETEXT_CHEMO),
names_to = "source",
values_to = "merged_value"
) %>%
drop_na(merged_value)
View(NSCLC_long)
NSCLC_long <- NSCLC_text %>%
select(PATIENT_ID, TREATMENT_PROCEDURETEXT_BRM, TREATMENT_PROCEDURETEXT_CHEMO) %>%
pivot_longer(
cols = c(TREATMENT_PROCEDURETEXT_BRM, TREATMENT_PROCEDURETEXT_CHEMO),
names_to = "source",
values_to = "merged_value"
) %>%
drop_na(merged_value)
NSCLC_long <- NSCLC_text %>%
select(StudyID,CTCCTC_ID, TREATMENT_PROCEDURETEXT_BRM, TREATMENT_PROCEDURETEXT_CHEMO) %>%
pivot_longer(
cols = c(TREATMENT_PROCEDURETEXT_BRM, TREATMENT_PROCEDURETEXT_CHEMO),
names_to = "source",
values_to = "merged_value"
) %>%
drop_na(merged_value)
View(NSCLC_long)
NSCLC_long<- NSCLC_long %>%
mutate(StudyID = row_number())
install.packages("writexl")
library(writexl)
# save  the file
write_xlsx(NSCLC_long, path = "N:/NSCLC/Merge_value.xlsx")
library(readxl)
library(meta)
# 1. Read the Excel file
data <- read_excel("C:/Users/user/Desktop/Emory/EPI590/Assignment 3/UPF_LAB_empty.xlsx")
View(data)
# 1. Read the Excel file
data <- read_excel("C:/Users/user/Desktop/Emory/EPI590/Assignment 3/test.xlsx")
m <- metagen(TE = data$Ln_Effect_estimate, seTE = data$Ln_SE, sm = "HR", method.tau = "DL")
# 4. View pooled estimate
summary(m)
exp(c(TE = m$TE.random, LCL = m$lower.random, UCL = m$upper.random))
#forest plot
forest (m)
m <- metagen(
TE = data$Ln_Effect_estimate,    # log(HR)
seTE = data$Ln_SE,               # standard error of log(HR)
studlab = paste(data$Study, data$Year, sep = ", "),  # combines study name & year
sm = "HR",                       # summary measure
method.tau = "DL",               # DerSimonian–Laird
data = data
)
#forest plot
forest (m)
# Load libraries
library(ggplot2)
# Create data
df <- data.frame(
Category = c("Mapped criteria", "Not mapped criteria", "Not applicable criteria"),
Mean = c(80.6, 16.3, 3.0),
SD = c(25.26, 24.5, 5.6)
)
# Plot
ggplot(df, aes(x = Category, y = Mean)) +
geom_col(fill = "#FFC000", width = 0.6) +  # Excel-like gold color
geom_errorbar(aes(ymin = pmax(Mean - SD, 0), ymax = Mean + SD),
width = 0.2, color = "#E46C0A", linewidth = 1) +
geom_text(aes(label = Mean),
vjust = -0.8, size = 4.5, color = "#E46C0A", fontface = "bold") +
scale_y_continuous(limits = c(0, 100), expand = c(0,0)) +
labs(
title = "Median Proportion of Mapped Eligibility Criteria\n(Hypothetical target trial)",
x = "Subgroups",
y = "(%)"
) +
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 15),
axis.title.x = element_text(face = "bold", size = 13, margin = margin(t = 10)),
axis.title.y = element_text(face = "bold", size = 13, margin = margin(r = 10)),
axis.text.x = element_text(face = "bold", size = 11, color = "black"),
axis.text.y = element_text(size = 11, color = "black"),
panel.grid.major.x = element_blank(),
panel.grid.minor = element_blank()
)
df$lower <- pmax(df$Mean - df$SD, 0)
df$upper <- pmin(df$Mean + df$SD, 100)
ggplot(df, aes(x = Category, y = Mean)) +
geom_col(fill = "#FFC000", width = 0.6) +
geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2, color = "#E46C0A", linewidth = 1) +
geom_text(aes(label = Mean), vjust = -0.8, size = 4.5, color = "#E46C0A", fontface = "bold") +
scale_y_continuous(limits = c(0, 100), expand = c(0, 0)) +
labs(
title = "Mean Proportion of Mapped Eligibility Criteria\n(Hypothetical target trial)",
x = "Subgroups", y = "(%)"
) +
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(hjust = 0.5, face = "bold"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold", color = "black"),
axis.text.y = element_text(color = "black"),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank()
)
cox_td <- coxph(
Surv(SURVT, STATUS) ~ TX + tt(TX),
data = vets,
ties = "breslow",
tt = function(x, t, ...) {
x * t   # g(t) = t
}
)
library(survival)
library (survminer)
vets <- haven::read_sas("C:/Users/user/Desktop/Emory/EPI 550/vets.sas7bdat")
cox_td <- coxph(
Surv(SURVT, STATUS) ~ TX + tt(TX),
data = vets,
ties = "breslow",
tt = function(x, t, ...) {
x * t   # g(t) = t
}
)
cox_td
cox_td <- coxph(
Surv(SURVT, STATUS) ~ TX + tt(TX),
data = vets,
ties = "breslow",
tt = function(x, t, ...) {
x * t   # g(t) = ln(t)
}
)
cox_td
cox_td <- coxph(
Surv(SURVT, STATUS) ~ TX + tt(TX),
data = vets,
ties = "breslow",
tt = function(x, t, ...) {
as.numeric (x) * t   # g(t) = t
}
)
cox_td
cox_td <- coxph(
Surv(SURVT, STATUS) ~ TX + tt(TX),
data = vets,
ties = "breslow",
tt = function(x, t, ...) {
x * log (t)   # g(t) = ln(t)
}
)
cox_td
vets$AGE
min (vets$AGE)
max (vets$AGE)
#2
quantile(vets$AGE, probs = c(0, 1/3, 2/3, 1))
vets$AGEgrp <- cut(
vets$AGE,
breaks = quantile(vets$AGE, probs = c(0, 1/3, 2/3, 1)),
include.lowest = TRUE,
labels = c("Low", "Medium", "High")
)
vets$AGEgrp <- cut(
vets$AGE,
breaks = quantile(vets$AGE, probs = c(0, 1/3, 2/3, 1)),
include.lowest = TRUE,
labels = c("34-55", "56-64", "65-81")
)
vets$AGEgrp
fit <- survfit(Surv(SURVT, STATUS) ~ AGEgrp, data=vets)
ggsurvplot( fit,  linewidth = 0.8, title = "Product-Limit Survival Estimates")
ggsurvplot( fit,  linewidth = 0.8, title = "Product-Limit Survival Estimates_1group")
fit <- survfit(Surv(SURVT, STATUS) ~ AGE, data=vets)
ggsurvplot( fit,  linewidth = 0.8, title = "Product-Limit Survival Estimates_1group")
# 2 groups by median age
median(vets$AGE)
vets$AGEgrp2 <- ifelse(vets$AGE <= median(vets$AGE), "Younger", "Older")
# KM plot
fit2 <- survfit(Surv(SURVT, STATUS) ~ AGEgrp2, data = vets)
ggsurvplot(fit2, linewidth = 0.8, title = "Product-Limit Survival Estimates by Age (2 groups)")
#COX
cox2<- coxph(Surv(SURVT, STATUS) ~ AGE, data = vets)
cox.zph(cox_model)
cox.zph(cox2)
cox_model <- coxph(Surv(SURVT, STATUS) ~ TX, data = vets)
cox.zph(cox_model)
cox_td2 <- coxph(
Surv(SURVT, STATUS) ~ AGE + tt(AGE),
data = vets,
ties = "breslow",
tt = function(x, t, ...) {
as.numeric (x) * t   # g(t) = t
}
)
summary(cox_td2)
cox_lnd <- coxph(
Surv(SURVT, STATUS) ~ AGE + tt(AGE),
data = vets,
ties = "breslow",
tt = function(x, t, ...) {
x * log (t)   # g(t) = ln(t)
}
)
summary(cox_lnd2)
cox_lnd2 <- coxph(
Surv(SURVT, STATUS) ~ AGE + tt(AGE),
data = vets,
ties = "breslow",
tt = function(x, t, ...) {
x * log (t)   # g(t) = ln(t)
}
)
summary(cox_lnd2)
fit3 <- survfit(Surv(SURVT, STATUS) ~ PRIORTX, data=vets)
ggsurvplot( fit3,  linewidth = 0.8, title = "Product-Limit Survival Estimates")
cox_model_3 <- coxph(Surv(SURVT, STATUS) ~ PRIORTX, data = vets)
cox.zph(cox_model_3)
cox_td_3 <- coxph(
Surv(SURVT, STATUS) ~ PRIORTX + tt(TX),
data = vets,
ties = "breslow",
tt = function(x, t, ...) {
as.numeric (x) * t   # g(t) = t
}
)
summary(cox_td_3)
cox_lnd_3 <- coxph(
Surv(SURVT, STATUS) ~ PRIORTX + tt(TX),
data = vets,
ties = "breslow",
tt = function(x, t, ...) {
x * log (t)   # g(t) = ln(t)
}
)
summary(cox_lnd_3)
#5
cox_model_5 <- coxph(Surv(SURVT, STATUS) ~ strata (PRIORTX)+AGE, data = vets)
cox.zph(cox_model_5)
summary(cox_model_3)
summary(cox_model_5)
library(survival)
library (survminer)
fit2 <- survfit(Surv(SURVT, STATUS) ~ AGEgrp2, data = vets)
vets <- haven::read_sas("C:/Users/user/Desktop/Emory/EPI 550/vets.sas7bdat")
fit <- survfit(Surv(SURVT, STATUS) ~ AGEgrp, data=vets)
#KM plot
fit <- survfit(Surv(SURVT, STATUS) ~ TX, data=vets)
ggsurvplot( fit,  linewidth = 0.8, title = "Product-Limit Survival Estimates", fun= "cloglog")
quantile(vets$AGE, probs = c(0, 1/3, 2/3, 1))
vets$AGEgrp <- cut(
vets$AGE,
breaks = quantile(vets$AGE, probs = c(0, 1/3, 2/3, 1)),
include.lowest = TRUE,
labels = c("34-55", "56-64", "65-81")
)
vets$AGEgrp <- cut(
vets$AGE,
breaks = quantile(vets$AGE, probs = c(0, 1/3, 2/3, 1)),
include.lowest = TRUE,
labels = c("34-55", "56-64", "65-81")
)
#KM plot
fit <- survfit(Surv(SURVT, STATUS) ~ AGEgrp, data=vets)
ggsurvplot( fit,  linewidth = 0.8, title = "Product-Limit Survival Estimates",fun= "cloglog")
median(vets$AGE)
vets$AGEgrp2 <- ifelse(vets$AGE <= median(vets$AGE), "Younger", "Older")
# KM plot
fit2 <- survfit(Surv(SURVT, STATUS) ~ AGEgrp2, data = vets)
ggsurvplot(fit2, linewidth = 0.8, title = "Product-Limit Survival Estimates by Age (2 groups)", fun= 'cloglog' )
fit3 <- survfit(Surv(SURVT, STATUS) ~ PRIORTX, data=vets)
ggsurvplot( fit3,  linewidth = 0.8, title = "Product-Limit Survival Estimates", fun= 'cloglog' )
cox_td_3 <- coxph(
Surv(SURVT, STATUS) ~ PRIORTX + tt(PRIORTX),
data = vets,
ties = "breslow",
tt = function(x, t, ...) {
as.numeric (x) * t   # g(t) = t
}
)
summary(cox_td_3)
cox_lnd_3 <- coxph(
Surv(SURVT, STATUS) ~ PRIORTX + tt(PRIORTX),
data = vets,
ties = "breslow",
tt = function(x, t, ...) {
x * log (t)   # g(t) = ln(t)
}
)
summary(cox_lnd_3)
cox_model <- coxph(Surv(SURVT, STATUS) ~ TX, data = vets)
cox.zph(cox_model)
cox_model_5 <- coxph(Surv(SURVT, STATUS) ~ PRIORTX+AGE, data = vets)
summary(cox_model_5)
cox_model_a <- coxph(Surv(SURVT, STATUS) ~ PRIORTX, data = vets)
summary(cox_model_a)
cox_model_5 <- coxph(Surv(SURVT, STATUS) ~ PRIORTX+AGE, data = vets)
summary(cox_model_5)
install.packages("renv")
renv::init ()
getwd ("C:/Users/user/Documents/collaborating_renv/")
getwd ("C:/Users/user/Documents/collaborating_renv")
setwd ("C:/Users/user/Documents/collaborating_renv")
getwd
getwd ()
renv::restore
renv::restore ()
